// Generated by CoffeeScript 1.9.1
module.exports = function(log, model, suffix) {
  return function(requiredFields, entries, body, next) {
    entries.filtered = [];
    return model.all(function(err, entryObjects) {
      var entry, entryHash, i, len;
      if (err) {
        return next(err);
      }
      entryHash = {};
      for (i = 0, len = entryObjects.length; i < len; i++) {
        entry = entryObjects[i];
        entryHash[entry.date.toISOString()] = entry;
      }
      entries.filtered = entries.fetched.filter(function(entry) {
        return entryHash[entry.date.toISOString()] == null;
      });
      return next();
    });
  };
};
